function S = generatestiffnessmatrix(obj,grid)
%GENERATESTIFFNESSMATRIX(obj,grid) 

% VARIABLES
m = length(grid)-2;

% STIFFNESS MATRIX
% Inverval lengths and inverses
D    = diff(grid);
Dinv = 1./D;

% Main diagonal
mainDiag = Dinv(1:m) + Dinv(2:m+1);

% Off diagonal
offDiag  = -Dinv(2:m);

% Stiffness matrix
S = sparse(diag(mainDiag,0) + diag(offDiag,1) + diag(offDiag,-1));

end

